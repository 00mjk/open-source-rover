\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{color}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{framed}
\usepackage{xcolor}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{fancyhdr}
\usepackage{verbatim}
\usepackage{wrapfig}
\usepackage{tcolorbox}
\usepackage{lipsum}

\pagestyle{fancy}
\lfoot{\textbf{Open Source Rover Electrical Assembly}}
\rfoot{Page \thepage}
\lhead{\textbf{\leftmark}}
\rhead{\textbf{\rightmark}}
\cfoot{}
\renewcommand{\footrulewidth}{1.8pt}
\renewcommand{\headrulewidth}{1.8pt}
\doublespacing
\setlength{\parindent}{1cm}


\definecolor{mycolor}{rgb}{0.122, 0.435, 0.698}% Rule colour
\makeatletter
\newcommand{\mybox}[1]{%
  \setbox0=\hbox{#1}%
  \setlength{\@tempdima}{\dimexpr\wd0+13pt}%
  \begin{tcolorbox}[colframe=mycolor,boxrule=0.5pt,arc=4pt,
      left=6pt,right=6pt,top=6pt,bottom=6pt,boxsep=0pt,width=0.95\textwidth]
    #1
  \end{tcolorbox}
}
\makeatother



\begin{document}

\title{Open Source Rover}
\author{Electrical Assembly Instructions}

\makeatletter         
\def\@maketitle{
\begin{center}	
	\makebox[\textwidth][c]{ \includegraphics[width=1.05\paperwidth]{"Pictures/Electronics/electronics title".png}}
	{\Huge \bfseries \sffamily \@title }\\[4ex] 
	{\huge \bfseries \sffamily \@author}\\[4ex] 
	\includegraphics[width=.85\linewidth]{"Pictures/Electronics/JPL logo".png}
\end{center}}
\makeatother

\maketitle

% Introduction
\newpage


\tableofcontents

\newpage

%
%\begin{figure}[H]
%\centering	
%	\includegraphics[width=1\linewidth]{"Pictures/Parts/Struct_Elec parts".PNG}
%	\caption{Mechanical and Electrical Parts}
%	\label{parts1}
%\end{figure}
%
%\begin{figure}[H]
%\centering	
%	\includegraphics[width=1\linewidth]{"Pictures/Parts/Screws and Spacers".PNG}
%	\caption{Screws and Standoffs Parts}
%	\label{parts2}
%\end{figure}
%
%\newpage


\section{Overview}

First it is important to look at the components used in the rover and understand both the data transmission and power system for the rover. Figure \ref{power} shows how each of the electrical components and boards receive power, and Figure \ref{data} shows how data is sent from each of the electrical systems and what communication protocol it uses. 
\begin{figure}[H]
  	\centering
    	\includegraphics[width=1\textwidth]{"Pictures/Electronics/power diagram".PNG}
  	\caption{Electrical Power Overview}
	\label{power}
\end{figure}

\noindent A few things to note from this is that there are multiple different voltages in the system, there is the unregulated voltage coming from the battery, 5V regulated coming from a voltage regulator, and the 12V motor voltage being sent from the motor controllers to the motors. 

\begin{figure}[H]
  	\centering
   	\includegraphics[width=1\textwidth]{"Pictures/Electronics/data diagram".PNG}
  	\caption{Electrical Data Overview}
	\label{data}
\end{figure}

\noindent For the data transmission there is the use of both a 3.3V and 5V digital logic system, analog signals of different max voltages, and Serial communication between devices. Information on these can be found at:

\begin{itemize}
	\item \href{https://en.wikipedia.org/wiki/Serial_communication}{https://en.wikipedia.org/wiki/Serial\_communication}
	\item \href{https://learn.sparkfun.com/tutorials/analog-vs-digital}{https://learn.sparkfun.com/tutorials/analog-vs-digital}
\end{itemize}


\begin{tabular}[2]{|p{4cm}|p{11cm}|}
	\hline
	\textbf{Part} & \textbf{Description} \\ \hline
	Battery & Provides power to the system. Has an unregulated voltage range of around 11.5V - 16.75V depending on it's charge level \\ \hline
	Switch & Mechanical disconnect of the electrical power to the rest of the robot \\ \hline
	Volt Meter & Monitors and displays information such as current draw, voltage level, and power consumption of the robot \\ \hline
	Voltage Regulator & Takes in the unregulated battery voltage and outputs a steady regulated voltage of 5 volts for consumption of electronics. \\ \hline
	Raspberry Pi 3 & Acts as the brains and processing power of the robot \\ \hline
	LED Matrix & Gives a display to the robot \\ \hline
	Motor Controllers & Send voltage signals to the motors as to direction/speed to spin at, and read encoder data \\ \hline
	Encoders & Monitors the spinning of the motor to give data like speed and position \\ \hline
	Custom PCBs & Single purpose boards made custom for this project, each of which will be explained later on in this document. \\ \hline
\end{tabular}

\subsection{Tools Necessary}

\begin{figure}[H]
  	\centering
   	\includegraphics[width=0.8\textwidth]{"Pictures/Electronics/elec parts".PNG}
  	\caption{}
	\label{elec parts}
\end{figure}

This project assumes you have some basic electronics components shown in Figure \ref{elec parts}. These will all be used in the construction and testing/debugging of this project. Most of these can be purchased inexpensively though digikey or amazon. 

\subsection{Component Descriptions}
The following are brief descriptions and notes about some of the components used. For more information on each you should consult the data sheet for each respective component. 
\subsubsection{Battery}
The battery is used to power all the electrical components, and the motors for this project. The biggest driving factor for battery selection was safeness of the battery while keeping able to drive the current and voltage necessary for operation of all the electronics (we'll go into operating specs more later). The recommended battery was chosen because of it's Poly Switch and PCB protection. These limit the amount of current that can be pulled from the battery, as well as giving protection against things like electrical shorts, and overcharging/fully discharging the battery. 
\subsubsection{Voltage Regulators}
As the battery selected outputs unregulated voltage based on it's charge level voltage regulators are added to give steady DC voltage power to the electronics components. There is a 5V regulator that runs the raspberry pi and the LED matrix, and a 12V regulator that will supply power to the motors which run on 12Volts. 
\subsubsection{Raspberry Pi 3}
The Raspberry Pi 3 Model B was selected as the "brain" of the project. It was chosen for its capability of adding projects and modules to the robot, as it is the most widely developed on open source platform in the world right now. Model B was selected as it comes with the wifi and bluetooth modules built into the board and don't need external devices for them, allowing the user all 4 USB ports for addons and plug-ins to the project.  

\subsubsection{Printed Circuit Boards}
In order to help with the electronics of this system we designed a few single purpose Printed Circuit Boards (PCBs). In total there are three boards, which are for the following:
\bigskip

\begin{tabular}[2]{| p{5cm} | p{10cm} | }
	\hline
	\textbf{Board} & \textbf{Description/Purpose} \\ \hline
	Voltage Divider & Distributes the +5V and GND to power the absolute encoders. Then takes the 0-5V signal from the encoders and transforms it to a 0-2V signal output \\ \hline
	Logic Shifter & Takes the 3.3V digital signals from the raspberry pi and converts them to a 5V digital signal output \\ \hline
	Serial Splitter & Splits out the TX/RX serial read/write lines as well as the +5V and GND power pins from the Raspberry Pi and distributes them to each motor controller. \\ \hline
\end{tabular}
\bigskip

Each of these boards will come unpopulated with components on it, which you will have to solder on yourself.  For tips on how to solder into the circuit boards some more information can be found at:
\begin{itemize}
	\item \href{https://www.youtube.com/watch?v=3R0zE_7Xz_4}{https://www.youtube.com/watch?v=3R0zE\_7Xz\_4}
\end{itemize}


\subsubsection{LED Matrix}
The LED Matrix gives a 16x32 pixel display, controlled through the raspberry pi. In order to integrate this we followed along with an Adafruit project (but added our own custom PCB which isn't in this tutorial) which can be found at: \footnote{The step by step process of this lives in its' own document, this project extension uses a lot of GPIO pins and might want to be swapped out for a different set of devices.} 
\begin{itemize}
  \item \href{https://learn.adafruit.com/connecting-a-16x32-rgb-led-matrix-panel-to-a-raspberry-pi/overview}{https://learn.adafruit.com/connecting-a-16x32-rgb-led-matrix-panel-to-a-raspberry-pi/overview}
\end{itemize}


\subsubsection{Motors}
Motors are used to do the mechanical movement of the robot. There are many types of motors that exist, in this project we will be used brushed DC motors. More information on motor types and specifically how a brushed DC motor works can be found at the following links:
\begin{itemize}
	\item \href{https://en.wikipedia.org/wiki/Brushed_DC_electric_motor}{https://en.wikipedia.org/wiki/Brushed\_DC\_electric\_motor}
	\item \href{https://en.wikipedia.org/wiki/Electric_motor}{https://en.wikipedia.org/wiki/Electric\_motor}
\end{itemize}

\subsubsection{Encoders}
Encoders are used to get readings on positions and speed of motors as they spin. There are two types used in this project, absolute and quadrature. An absolute encoder is used to get the position of the motor on a fixed scale such that you always know the position even after power cycling the system. This type of encoder will usually have one output, which will either be a PWM digital signal, or an analog signal, each of which will have a specific reading corresponding to the fixed position scale. These are typically more expensive than their quadrature encoder counterparts, which will sense position only relative to the last time the power was cycled or the signal was reset. Quadrature encoders use two digital signals and will look at the different between the signals to sense movement, more information about quadrature encoders can be found at: 

\begin{itemize}
	\item \href{http://www.dynapar.com/Technology/Encoder_Basics/Quadrature_Encoder/}{http://www.dynapar.com/Technology/Encoder\_Basics/Quadrature\_Encoder/}  
\end{itemize}

\noindent In this project absolute encoders will be used on the corner wheels to get absolute measurements on where the wheels are turned, and quadrature encoders are used at each of the driving wheels to get speed measurements.


\section{Printed Circuit Boards}

\subsection{Voltage Divider Board}

\subsubsection{Overview/Schematic}

The purpose of this board is to solve the mismatch between the encoder logic and what the motor controller expects as encoder inputs. The absolute encoder outputs a signal from 0-5V based on the position of the encoder shaft, but the motor controllers expect in a signal that is 0-2V. For that we will need to linearly divide our scale such that these two match up to each other.

\mybox{
\noindent The following schematic is the electrical diagram for this board. For information on learning how to read electrical schematics you can read more at:

\centering
\href{https://learn.sparkfun.com/tutorials/how-to-read-a-schematic}{https://learn.sparkfun.com/tutorials/how-to-read-a-schematic}
}

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.95\textwidth]{"Pictures/Electronics/Encoder Schematic".PNG}
 	\caption{Encoder voltage divider schematic}
	\label{evd sch}
\end{figure}

The Op-amp chip chosen is a dual channel OP-amp, so it will contain two separate input/outputs on each chip. The pin-out can be seen in Figure \ref{opamp}. For more information on this OP-amp you can see its' data sheet at 
\begin{itemize}
	\item \href{http://www.ti.com/lit/ds/symlink/lm358.pdf}{http://www.ti.com/lit/ds/symlink/lm358.pdf}
\end{itemize}

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.35\textwidth]{"Pictures/Electronics/OP amp".PNG}
 	\caption{Op amp pinout}
	\label{opamp}
\end{figure}

\mybox{
In Figure \ref{evd sch} we can see the electrical schematic for this board. Duplicated 4 times on this board is a voltage divider with a voltage follower after it. The voltage divider with the given values of 22K and 10K ohms will give a voltage division of about 0.3125 given from the following equation:


\centering
$V_{out} = V_{in} \frac{R_2}{R_1+R_2}$


\noindent However we see that practically we see that the voltage division is actually closer to 0.28, this is because of other resistances of electronics components. Any division that gives us a division of at least 0.4 will be sufficient, as we need to get our 5V signal less than 2V. You can tune resistor values to get this closer if you wish. 
}

The Op-amp is used as a voltage follower allowing you to decouple the resistors and the impedance/capacitance of the motor controllers, allowing you to maintain this simple voltage divider. More information on this can be found at 

\begin{itemize}
	\item \href{https://en.wikipedia.org/wiki/Voltage_divider}{https://en.wikipedia.org/wiki/Voltage\_divider}
	\item \href{http://hyperphysics.phy-astr.gsu.edu/hbase/Electronic/opampvar2.html}{http://hyperphysics.phy-astr.gsu.edu/hbase/Electronic/opampvar2.html}
\end{itemize}


\subsubsection{Testing}

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.75\textwidth]{"Pictures/Electronics/vd parts".PNG}
 	\caption{}
	\label{}
\end{figure}

The following diagram in Figure \ref{vd pinout1} are how the pins are labeled and will help us debug the board and pin the correct signals onto the pins
\begin{figure}[H]
 	\centering
	\includegraphics[width=.65\textwidth]{"Pictures/Electronics/Encoder Board".PNG}
 	\caption{Encoder Voltage Divider board pinout}
	\label{vd pinout1}
\end{figure}


\begin{enumerate}
	\item The board will come unpopulated and will look like the Figure \ref{}. First take and solder all of the header pins, resistors, and op amp chips into the board. 

\textcolor{red}{THIS SECTION NEEDS PICTURES ADDED FOR PIN-OUT DEBUGGING. WILL BE ADDED ONCE WE GET THEM FROM SANTA SUSANA}
\mybox{
Make sure that the OP-amp is facing the correct direction, there is a half moon on the top of the chip as well as on the silk screen on the board. 
}
	\item Once soldered the board should look like Figure \ref{}
	\item Apply +5V onto pin 25 and GND on pin 26, this should supply power to the components on the board.
	\item Test each of the OP-amp chips, probing from pin 8 to 4 on each chip and verify they have +5V.
	\item Apply +5V onto pin 1 and GND onto pin 3. Verify that there is +5V across pin 13 and 15.
	\item Apply +5V onto pin 4 and GND onto pin 6. Verify that there is +5V across pin 16 and 18.
	\item Apply +5V onto pin 7 and GND onto pin 9. Verify that there is +5V across pin 19 and 21.
	\item Apply +5V onto pin 10 and GND onto pin 12. Verify that there is +5V across pin 22 and 24.
	\item Now we know that each of the encoders will be powered by +5V correctly, we want to test the voltage division. Apply +5V to pin 14 and measure the output at pin 2, this value should read between 1.4V and 2.0V. It is important that it is strictly less than 2V, but other than that any values should be okay. Resistor values can be changed if desired to make this closer. 
	\item Repeat step 8 with +5V on 17 and testing pin 5, then +5 on 20 testing at pin 8, and +5V on 23 testing at pin 11. Once all these are verified the board is working correctly and is ready for the rest of the project. If any of the tests fail check resistor values, as well as the Op-amp chip.  
\end{enumerate}

\subsection{Serial Splitter Board}


\subsubsection{Overview/Schematic}

This board is to pass the serial read and write lines, as well as +5V/GND from the Raspberry Pi to each of the motor controllers without having to solder wires to split each of these individually. 

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.85\textwidth]{"Pictures/Electronics/Read write schematic".PNG}
 	\caption{Serial Read/Write schematic}
	\label{rw sch}
\end{figure}

Figure \ref{rw sch} shows the schematic for this board. There is one resistor used as a pull-up resistor as recommended when using multiple serial communication devices from the RoboClaw user manual. +5V and GND are also passed to each motor controller, as this is what is used for the logic battery on the RoboClaw, which determines what digital logic and signal power is sent to the encoders. 

\subsubsection{Testing}

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.85\textwidth]{"Pictures/Electronics/ss parts".PNG}
\end{figure}


\begin{enumerate}
	\item The board will come unpopulated and will look like the Figure \ref{ss}. First take and solder the 4.7K resistor and all of the header pins into 		the board. 

	\begin{figure}[H]
	  	\centering
	    	\includegraphics[width=.45\textwidth]{"Pictures/Electronics/serial splitter board".PNG}
		\caption{Unpopulated Serial Splitter Board}
		\label{ss}
	\end{figure}

	\item Once soldered on the board should look like Figure \ref{ss1}

	\begin{figure}[H]
	  	\centering
	    	\includegraphics[width=.45\textwidth]{"Pictures/Board Testing/ss1".PNG}
		\caption{populated Serial Splitter Board}
		\label{ss1}
	\end{figure}

	\item We first want to test and make sure that each of the rows are independent of each other. Using the resistance setting make sure that there is 		no resistance between any pins in the first row (+5V), and any pins in the 2nd (TX) and 4th (GND) row. 

	\begin{figure}[H]
	 	\centering
	  	\begin{minipage}[b]{0.45\textwidth}
			\includegraphics[width=\textwidth]{"Pictures/Board Testing/ss2".PNG}
	  	\end{minipage}
	  	\hfill
	  	\begin{minipage}[b]{0.45\textwidth}
	    		\includegraphics[width=\textwidth]{"Pictures/Board Testing/ss4".png}
	  	\end{minipage}
		\label{sstest1}
	\end{figure}

	\item Now test the resistance between row 1 and row 3, the +5V row and RX row. This should be equal to the resistance of R1, which is 4.7K 			Ohms. 

	\begin{figure}[H]
	  	\centering
	    	\includegraphics[width=.45\textwidth]{"Pictures/Board Testing/ss3".PNG}
		\label{ss3}
	\end{figure}
	
	\item Every row should be connected all the way across, so verify that the first pin is connected to each of the other pins in the row. If all of these 		tests have passed then the board is all ready to go, if not check solder connections and make sure there isn't any short on the board. 

	\begin{figure}[H]
	  	\centering
	    	\includegraphics[width=.45\textwidth]{"Pictures/Board Testing/ss5".PNG}
		\label{ss5}
	\end{figure}

\end{enumerate}


\section{Powering Components}
Here we will be setting up the connections to the electrical components. It is recommended that you try hooking up each of these components outside of the robot body first to test in an easier environment, as well as make sure you fully understand how all the signals are passed around etc. When connecting any of the power lines it is important to consider how much current will be running through that wire, and select the appropriate wire gauge to handle that current. For more information on wire gauge selection you can follow this link:
  
\begin{itemize}
	\item \href{https://www.bluesea.com/support/articles/Circuit_Protection/1437/Part_1\%3A_Choosing_the_Correct_Wire_Size_for_a_DC_Circuit}{https://www.bluesea.com/support/articles/Circuit\_Protection/1437}
\end{itemize}

\noindent During this project you will need to cut, strip wires, and solder them to extend and split electrical connections. It is important to understand how to do this safely such that you are protecting your system from electrical shorts. Below are a few quick bits of information on these, however make sure to fully understand these processes before proceeding. 

\begin{itemize}
	\item \href{https://learn.sparkfun.com/tutorials/working-with-wire/how-to-strip-a-wire}{https://learn.sparkfun.com/tutorials/working-with-wire/how-to-strip-a-wire}
	\item \href{https://www.wikihow.com/Splice-Wire}{https://www.wikihow.com/Splice-Wire}
	\item \href{https://www.youtube.com/watch?v=Y8wjv6lj5KU}{https://www.youtube.com/watch?v=Y8wjv6lj5KU}
\end{itemize}

 \textbf{**Note** Please read through this entire section and understand it before starting to connect devices and electronics together. }

\subsection{Battery Connectors, Switch, and Volt Meter}

We'll start with the battery and connecting it through the switch and volt meter. Figure \ref{battery section} shows the section of the power diagram we'll be working on, with components and connections made in this section in \textcolor{red}{\textbf{RED}}.

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.9\textwidth]{"Pictures/Electronics/battery section".PNG}
 	\caption{Battery section Overview}
	\label{battery section}
\end{figure}

Using the Tamiya connectors connect the battery to the switch and then the volt meter following Figure \ref{sw sch}. The connectors are to be able to disconnect the battery from the rest of the system so you can charge the battery. 

\begin{figure}[H]
  	\centering
    	\includegraphics[width=1\textwidth]{"Pictures/Electronics/Switch schematic".PNG}
 	\caption{Battery connection through switch and volt meter}
	\label{sw sch}
\end{figure}

\mybox{
There are a couple of very important things to make sure as you are doing this, as with any project where you are working with batteries or electrical current:
\newline
\noindent The battery \textbf{IS LIVE AT ALL TIMES}. This means that at any point if they two terminals of the battery come in contact they will cause an electrical short. This will trigger the protection circuit in the battery, but we do not want to rely on that for safety. Make sure to keep the terminals of the +V and GND separated at all times with no possibility of contact.
\newline
\noindent The connectors will only fit together in one way\. That means you have to make sure your connections are right the first time when soldering them in, make sure to verify this before connecting anything to the battery.
\newline
\noindent The switch picked out is a Single Pole - Single Throw switch. This means that either the two terminals are connected together in one switch position or there is a physical disconnect when the switch is in the other position. Make sure to test the switch and know which is the ON and OFF positions for the switch previous to connecting it to anything.
\newline
\noindent  It is extremely important to plug the battery in the correct direction into the volt meter as well, as plugging it in backwards could damage the volt meter. 

}



The battery will live in the body of the rover above the electronics plate, with the switch mounting to any of your choice of the 0.5 in holes in the body, and the volt meter has a press fit cutout in the back panel. Measure your wire lengths accordingly for where you end up putting each of these components. 

\textcolor{red}{INSERT IMAGES ABOUT PUTTING THE BATTERY/SWITCH ON THE ROVER}

\subsection{Volt Meter and Voltage Regulator}
Next is connecting the output side of the volt meter to the 5V voltage regulator and the motor controllers. Figure \ref{motor cont} shows the section of the power diagram we'll be working on, with components and connections made in this section in \textcolor{red}{\textbf{RED}}.

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.9\textwidth]{"Pictures/Electronics/motor cont".PNG}
 	\caption{Regulator and Motor Controllers Overview}
	\label{motor cont}
\end{figure}


The "LOAD" terminals of the volt meter are the electrical load of the robot, which will be all the electronics running in the robot. Figure \ref{vm sch} shows the pin-out of how to connect the volt meter to the regulator and the motor controllers.

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.75\textwidth]{"Pictures/Electronics/Vm to reg".PNG}
 	\caption{Volt Meter to Electronics connections}
	\label{vm sch}
\end{figure}

\mybox{
\noindent  The LOAD+ pin should connect to VIN on the 5V Regulator, and + on each of the RoboClaw Motor Controllers, and the LOAD- pin should connect to GND on the Regulator and - on the RoboClaws. After the Volt Meter you should break out the connections to the regulator and RoboClaws into two separate wires, each with sufficient wire gauge. The 5V reg will be fine with 20AWG wire, but the one line running to every motor controller should be 16AWG.  
}

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.45\textwidth]{"Pictures/Electronics/5V in_out".PNG}
 	\caption{Voltage Regulator Diagram}
	\label{regs}
\end{figure}

\noindent Here in Figure \ref{vm2rcs} shows an example of one way we did the wire routing for power to the motor controllers. We can see that the power was split off before reaching any of the motor controllers, and instead each of them individually got a power and ground wire. 

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.75\textwidth]{"Pictures/Routing/power to rcs".PNG}
 	\caption{Powering the RoboClaws}
	\label{vm2rcs}
\end{figure}


\mybox{
Before connecting to the rest of the electronics we will want to test the voltage coming out of the regulators. To do this using a Multi-meter test across the  for the 5V regulator on pins VOUT and GND, \textbf{Be very careful not to short across the GND and VOUT pins while testing} as this could short the regulator and cause it to break.
}

\subsection{Powering the Raspberry Pi}
Next we need to bring power to the Raspberry Pi. It requires a regulated 5V DC power source, so it will be powered from the 5V regulator. Figure \ref{ss} shows the section of the power diagram we'll be working on, with the power connections shown in \textcolor{red}{\textbf{RED}}.

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.9\textwidth]{"Pictures/Electronics/rpi power".PNG}
 	\caption{Powering the Raspberry Pi}
	\label{rpi power}
\end{figure}

\mybox{
\textbf{Note:} If you plan on using the LED matrix you should split 5V power off of the 5V regulator before the Raspberry Pi, and that should be done now. As the LED Matrix takes up a large number of GPIO pins which some might want for other devices it's not a required part of the project, and thus there is a separate document describing how to put it together.
} 


\noindent The method we used to power the pi is soldering to the power pads on the bottom of the Raspberry Pi, the positive voltage goes to pad PP2 and negative/ground goes to pad PP5. For more information and a video on doing this you can follow this link and go to around 3:30 
\begin{itemize}
	\item \href{"https://www.youtube.com/watch?v=9LAtu39xpR8"}{"https://www.youtube.com/watch?v=9LAtu39xpR8"} . 
\end{itemize}
%\begin{figure}[H]
% 	\centering
%	\includegraphics[width=.55\textwidth]{"Pictures/Electronics/Rpi solder pads".PNG}
% 	\caption{Raspberry Pi Solder pads}
%	\label{pi solder pads}
%\end{figure}

\begin{figure}[H]
 	\centering
  	\begin{minipage}[b]{0.40\textwidth}
		\includegraphics[width=\textwidth]{"Pictures/Electronics/Rpi solder pads".PNG}
  	\end{minipage}
  	\hfill
  	\begin{minipage}[b]{0.50\textwidth}
    		\includegraphics[width=\textwidth]{"Pictures/Electronics/rpi solder diagram".png}
  	\end{minipage}
	\caption{Raspberry Pi 3 soldering pads}
	\label{rpi pads}
\end{figure}



\subsection{Serial Communication}

\textbf{Connecting the Raspberry Pi to Serial Splitter Board:} In order for the Raspberry Pi to talk to the motor controllers we will be using Serial communication. Figure \ref{ss} shows the section of the power diagram we'll be working on, with the power connections shown in \textcolor{red}{\textbf{RED}}, and data lines in \textcolor{blue}{\textbf{BLUE}}. 

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.9\textwidth]{"Pictures/Electronics/serial split".PNG}
 	\caption{Serial Splitter Overview}
	\label{ss}
\end{figure}


%\begin{figure}[H]
% 	\centering
%  	\begin{minipage}[b]{0.48\textwidth}
%		\includegraphics[width=\textwidth]{"Pictures/Electronics/serial split".PNG}
%  	\end{minipage}
%  	\hfill
%  	\begin{minipage}[b]{0.48\textwidth}
%    		\includegraphics[width=\textwidth]{"Pictures/Electronics/serial data".png}
%  	\end{minipage}
%	\caption{Serial Overview}
%	\label{ss}
%\end{figure}


Figure \ref{rpi to rc} shows the schematic and pin-out of how to connect the RPI, Serial Splitter board, and Motor Controllers. From the Raspberry Pi the pins we will use are going to be the UART TX and RX pins, which correspond to pins \#8 and \#10, or GPIO14 and GPIO15. In addition we will be passing 5V to the motor controllers for the logic battery controller which is used by the encoders and digital logic. For this use the 5V PWR rail, or pin  \#02 or \#04, and any of the GND pins (we recommend pin \#06). Raspberry Pi GPIO diagrams can be found on the following page in Figure \ref{RPi 3 pinout}

\begin{figure}[H]
 	\centering
	\includegraphics[width=.85\textwidth]{"Pictures/Electronics/ReadWrite hookup schematic".PNG}
 	\caption{RPi connections to RoboClaws}
	\label{rpi to rc}
\end{figure}


Below shows the description of what each pin connects from and to on the Serial Splitter board. Use this in combination with Figure \ref{rpi to rc} and Figure \ref{Read/Write Board} to make the serial connections to the RoboClaw Motor Controllers. 

\bigskip

\begin{tabular}[2] {| p{2.5cm} | p{11cm} |}
	\hline
	\textbf{Pin} & \textbf{Description} \\ \hline
	\textcolor{red}{1} & \textcolor{red}{+5V from Raspberry Pi 5V DC pin \#2} \\ \hline
	\textcolor{green}{2} & \textcolor{green}{Serial Write line, TX from Raspberry Pi GPIO 14} \\ \hline
	\textcolor{magenta}{3} & \textcolor{magenta}{Serial Read line, RX from Raspberry Pi GPIO 15}	\\ \hline
	4 & GND from Raspberry Pi GND pin \#6 \\ \hline
	\textcolor{red}{5,9,13,17,21} & \textcolor{red}{5V to RoboClaws LB + pin} \\ \hline
	\textcolor{green}{6,10,14,18,22} & \textcolor{green}{Serial Write to RoboClaws S1 pin} \\ \hline
	\textcolor{magenta}{7,11,15,19,23} & \textcolor{magenta}{Serial Read to RoboClaws S2 pin} \\ \hline
	8,12,16,20,24 & GND to RoboClaws LB - pin \\ \hline 
\end{tabular}

\bigskip 

\mybox{Please note the difference between the pin labeling for the Raspberry Pi 3, and what the difference is between GPIO pin numbers, and the physical pin numbering. Consult Raspberry Pi forums and documentation if you are needing additional information}


\begin{figure}[H]
 	\centering
  	\begin{minipage}[b]{0.35\textwidth}
		\includegraphics[width=\textwidth]{"Pictures/Electronics/rp3_pinout2".PNG}
  	\end{minipage}
  	\hfill
  	\begin{minipage}[b]{0.45\textwidth}
    		\includegraphics[width=\textwidth]{"Pictures/Electronics/pi3_gpio".png}
  	\end{minipage}
	\caption{Raspberry Pi 3 pinout}
	\label{RPi 3 pinout}
\end{figure}

\begin{figure}[H]
 	\centering
	\includegraphics[width=.75\textwidth]{"Pictures/Electronics/ReadWriteBoard".PNG}
 	\caption{Read/Write Board}
	\label{Read/Write Board}
\end{figure}

\begin{figure}[H]
 	\centering
	\includegraphics[width=.75\textwidth]{"Pictures/Electronics/RoboClaw pinout".PNG}
 	\caption{RC pinout}
	\label{RC pinout}
\end{figure}

Next following Figure \ref{rpi to rc} and the pinout Figures \ref{Read/Write Board} and \ref{RC pinout} connect the signals out to each individual RoboClaw \footnote{The pin number in Figure \ref{rpi to rc} for the Serial Splitter Board corresponds to the pin numbers in Figure \ref{Read/Write Board}}. For more information on the pins for the RoboClaws and their purpose refer to the RoboClaw Manual and data sheet. 

\noindent Examples of the wiring and routing can be seen in Figure \ref{ss2rc1} and Figure \ref{ss2rc2}

\begin{figure}[H]
 	\centering
	\includegraphics[width=.75\textwidth]{"Pictures/Routing/ss2rc".PNG}
 	\caption{Serial Splitter to RoboClaws}
	\label{ss2rc1}
\end{figure}

\begin{figure}[H]
 	\centering
  	\begin{minipage}[b]{0.50\textwidth}
		\includegraphics[width=\textwidth]{"Pictures/Routing/ss2rc2".PNG}
  	\end{minipage}
  	\hfill
  	\begin{minipage}[b]{0.40\textwidth}
    		\includegraphics[width=\textwidth]{"Pictures/Routing/ss2rc3".png}
  	\end{minipage}
	\caption{Serial signal routing}
	\label{ss2rc2}
\end{figure}

\section{Connecting Motors/Encoders}

Next we can connect the Motors and encoders to the RoboClaw Motor Controllers. For each of the 10 motors you will need to be connecting motor power, as well as the encoders. This means that there will be Close to 60 Wires being routed between the motor controllers and motors/encoders, and it is important to try to keep your wires organized and bundled together well. Below is some learning information about strain relief and using wire braid in your electronics system.

\begin{itemize}
	\item \href{https://www.techopedia.com/definition/2301/strain-relief}{https://www.techopedia.com/definition/2301/strain-relief}
	\item \href{https://www.youtube.com/watch?v=FeCs98TSsYQ}{https://www.youtube.com/watch?v=FeCs98TSsYQ}
\end{itemize}


\begin{figure}[H]
 	\centering
	\includegraphics[width=.75\textwidth]{"Pictures/Electronics/wiring".PNG}
 	\caption{Wire routing examples}
	\label{wiring}
\end{figure}

\mybox{
An example of how we routed our wiring is shown by Figure \ref{wiring}. It is important to give strain relief in the cable as you are routing it through as you can see from our example, as well as giving extra wiring for the locations that can move. 
}

\begin{tabular}[3] {| p{2cm} | p{7cm} | p{4cm} |}
	\hline
	\textbf{Section} & \textbf{Wires Needed} & \textbf{Length [inches]}  \\ \hline
	\textcolor{blue}{A} & \textcolor{blue}{2x 24AWG \& 4x 30AWG} & \textcolor{blue}{??} \\ \hline
	\textcolor{cyan}{B} & \textcolor{cyan}{2x 24AWG \& 4x 30AWG} & \textcolor{cyan}{??} \\ \hline
	\textcolor{green}{C} & \textcolor{green}{2x 24AWG \& 4x 30AWG} & \textcolor{green}{??} \\ \hline
	\textcolor{red}{D} & \textcolor{red}{2x 24AWG \& 3x 30AWG} & \textcolor{red}{??} \\ \hline
	\textcolor{magenta}{E} & \textcolor{magenta}{2x 24AWG \& 3x 30AWG} & \textcolor{magenta}{??} \\ \hline
\end{tabular}

\begin{figure}[H]
 	\centering
	\includegraphics[width=.75\textwidth]{"Pictures/Electronics/wire labels".PNG}
 	\caption{Wire labels}
	\label{wire lengths}
\end{figure}

\subsection{Drive Motors}
At this point we want to connect our motors to the motor controllers, we will begin with the drive motors (the 6 motors at each of the bottom of the wheels). Figure \ref{motors over} shows the section of the power diagram we'll be working on, with lines with both encoder signals and motor power in \textcolor{violet}{\textbf{PURPLE}}.

\begin{figure}[H]
  	\centering
    	\includegraphics[width=.9\textwidth]{"Pictures/Electronics/motor overview".PNG}
 	\caption{Motor and Encoder Overview}
	\label{motors over}
\end{figure}


\noindent Make sure to look at which RoboClaw corresponds to which motors it is controlling. It is important that this ordering is preserved. Assign and mark each of your RoboClaws a number 1-5 and then follow Figure \ref{motorID} when connecting each to its' motors. 

\begin{figure}[H]
 	\centering
	\includegraphics[width=.75\textwidth]{"Pictures/Electronics/Motor ID".PNG}
 	\caption{RoboClaw - Motor Assignments}
	\label{motorID}
\end{figure}

Figure \ref{Motor pinout} shows what each socket in the connector to the motor goes to, and Figure \ref{RC to Drive} shows which of those should connect to what pin on the RoboClaw motor controllers. Note that the white wire is represented by pink in the diagram. \footnote{Figure \ref{RC to Drive} shows only a single motor controller and 2 motors, broken into 2 pictures to reduce clutter on the image and increase wire readability.} 
\begin{figure}[H]
 	\centering
	\includegraphics[width=.65\textwidth]{"Pictures/Electronics/Motor pinout".PNG}
 	\caption{Motor pinout}
	\label{Motor pinout}
\end{figure}


\begin{figure}[H]
 	\centering
  	\begin{minipage}[b]{0.475\textwidth}
		\includegraphics[width=\textwidth]{"Pictures/Electronics/RoboClaw to Drive".PNG}
  	\end{minipage}
  	\hfill
  	\begin{minipage}[b]{0.425\textwidth}
    		\includegraphics[width=\textwidth]{"Pictures/Electronics/RoboClaw to Drive2".png}
  	\end{minipage}
	\caption{Connecting RoboClaws to Drive Motors}
	\label{RC to Drive}
\end{figure}

\subsection{Corner Motors/Encoders}
The big difference between the corner motors and drive motors is the use of absolute encoders. These are encoders that are separate from the motor and so we have to do a little bit of work to get them to interface into the Motor Controllers well. Figure \ref{corner motors over} shows the section of the power diagram we'll be working on, with lines that power the motors in \textcolor{red}{\textbf{RED}}, and encoder signals in \textcolor{blue}{\textbf{BLUE}}.


\begin{figure}[H]
  	\centering
    	\includegraphics[width=.9\textwidth]{"Pictures/Electronics/corner motor".PNG}
 	\caption{Corner Motor and Encoder Overview}
	\label{corner motors over}
\end{figure}

 The corner motors only have the two connections to the physical motor, the (+) and (-) going to the top of the motor, however you must also hook up the Absolute encoder. When plugged in the encoder the 3-pin Micro connector will have 3 wires coming out of it, shown below.

\bigskip
\begin{tabular}[3] {| p{3cm} | p{7cm} | p{3cm} | }
	\hline
	\textbf{Pin} & \textbf{Description} & \textbf{Color} \\ \hline
	1 & +5V DC Power & \textcolor{orange}{\textbf{Orange}} \\ \hline
	2 & 0-5V Analog & \textcolor{blue}{\textbf{Blue}} \\ \hline
	3 & Ground & \textcolor{brown}{\textbf{Brown}} \\ \hline
\end{tabular}

\bigskip 

\textcolor{red}{INSERT PICTURE OF 3 PIN CONNECTOR IN THE ROVER HERE}


\mybox{
The absolute encoder will be hooked up similarly to the encoders for the drive motor on the RoboClaw side, with the exception of the OUTPUT B signal which doesn't exist for absolute encoder types, it just needs to send the 10-Bit analog signal to the RoboClaw. However there is an issue where the encoder outputs signals on a 0-5V scale, but the RoboClaw expects an input of 0-2V for an absolute encoder value. For this we will use the Encoder Voltage Divider PCB, the pinout of which can be seen in Figure \ref{vd pinout}. 
}

\begin{figure}[H]
 	\centering
	\includegraphics[width=.65\textwidth]{"Pictures/Electronics/Encoder Board".PNG}
 	\caption{Encoder Voltage Divider board pinout}
	\label{vd pinout}
\end{figure}

\begin{tabular}[2] {| l | c |}
	\hline
	\textbf{Pin} & \textbf{Description} \\ \hline
	1,4,7,10 & +5V Input to Encoders \\ \hline
	2,5,8,11 & 0-5V Signal from Encoders based on position \\ \hline
	3,6,9,12 & GND for Encoders \\ \hline \hline
	13,16,19,22 & +5V Power from each respective RoboClaw \\ \hline
	14,17,20,23 & 0-2V Signal Output to RoboClaws, after voltage division on board \\ \hline
	15,18,21,24 & GND from each respective RoboClaw \\ \hline \hline
	25 & +5V from Raspberry Pi power rail \\ \hline
	26 & GND from Raspberry Pi pin \\ \hline
\end{tabular}

\begin{figure}[H]
 	\centering
	\includegraphics[width=1\textwidth]{"Pictures/Electronics/RoboClaw to Steering".PNG}
 	\caption{Connecting RoboClaws to Corner Motors}
	\label{RC to Steering}
\end{figure}

Once all 10 of the motors are connected in the system we are ready to move onto the Motor tuning and calibration process. Make sure to double check all your wire connections and that they are into the correct pins before moving on. 

\end{document} 